
mapping product = ([
	20:	({ 65501, 65502, 65503, 65504, 65505, 65506, 65507, }),
	30:	({ 62300, 62301, 62302, 62303, 62304, 62305, 64501, 64502, 64503, 64504, 64505, 64506, 64507, 65508, 65509, 65510, 65511, 65512, 65513, 65514, }),
	40: 	({ 62306, 62307, 62308, 62309, 62310, 62311, 64508, 64509, 64510, 64511, 64512, 64513, 64514, 64515, 64516, 64517, 64518, 64519, 64520, 64521, 64522, 64523, 64524, 64525, 64526, 64527, 64528, 65515, 65516, 65517, 65518, 65519, 65520, 65521, }),
	50: 	({ 62312, 62313, 62314, 62315, 62316, 62317, 64529, 64530, 64531, 64532, 64533, 64534, 64535, 64536, 64537, 64538, 64539, 64540, 64541, 64542, 64543, 64544, 64545, 64546, 64547, 64548, 64549, 65522, 65523, 65524, 65525, 65526, 65527, 65528, }),
	60: 	({ 62318, 62319, 62320, 62321, 62322, 62323, 64550, 64551, 64552, 64553, 64554, 64555, 64556, 64557, 64558, 64559, 64560, 64561, 64562, 64563, 64564, 64565, 64566, 64567, 64568, 64569, 64570, 65529, 65530, 65531, 65532, 65533, 65534, 65535, }),
	70: 	({ 62324, 62325, 62326, 62327, 62328, 62329, 64571, 64572, 64573, 64574, 64575, 64576, 64577, 64578, 64579, 64580, 64581, 64582, 64583, 64584, 64585, 64586, 64587, 64588, 64589, 64590, 64591, 65536, 65537, 65538, 65539, 65540, 65541, 65542, }),
	80: 	({ 62330, 62331, 62332, 62333, 62334, 62335, 64592, 64593, 64594, 64595, 64596, 64597, 64598, 64599, 64600, 64601, 64602, 64603, 64604, 64605, 64606, 64607, 64608, 64609, 64610, 64611, 64612, 65543, 65544, 65545, 65546, 65547, 65548, 65549, }),
	90: 	({ 62336, 62337, 62338, 62339, 62340, 62341, 64613, 64614, 64615, 64616, 64617, 64618, 64619, 64620, 64621, 64622, 64623, 64624, 64625, 64626, 64627, 64628, 64629, 64630, 64631, 64632, 64633, 65550, 65551, 65552, 65553, 65554, 65555, 65556, }),
	100: 	({ 62342, 62343, 62344, 62345, 62346, 62347, 64634, 64635, 64636, 64637, 64638, 64639, 64640, 64641, 64642, 64643, 64644, 64645, 64646, 64647, 64648, 64649, 64650, 64651, 64652, 64653, 64654, 65557, 65558, 65559, 65560, 65561, 65562, 65563, }),
	110: 	({ 62348, 62349, 62350, 62351, 62352, 62353, 64655, 64656, 64657, 64658, 64659, 64660, 64661, 64662, 64663, 64664, 64665, 64666, 64667, 64668, 64669, 64670, 64671, 64672, 64673, 64674, 64675, 64697, 64698, 64699, 64700, 64701, 64702, 64703, 64704, 64705, 64706, 64707, 64708, 64709, 64710, 64711, 64712, 64713, 64714, 64715, 64716, 64717, 65564, 65565, 65566, 65567, 65568, 65569, 65570, 65571, 65572, 65573, 65574, 65575, 65576, 65577, }),
	120: 	({ 62354, 62355, 62356, 62357, 62358, 62359, 64676, 64677, 64678, 64679, 64680, 64681, 64682, 64683, 64684, 64685, 64686, 64687, 64688, 64689, 64690, 64691, 64692, 64693, 64694, 64695, 64696, }),
	]);

mapping white_product = ([
	0:	({ 61001, 62001, 62002, 62003, 63001, 63002, 63003, 64001, 64002, 64003, 64004, 64005, 64006, 65001, 65002, 65003, 66001, 66002, 66003, }),
	10:	({ 61002, 62004, 62005, 63004, 63005, 63006, 64007, 64008, 64009, 64010, 64011, 64012, 65004, 65005, 65006, 65007, 65008, 66004, 66005, 66006, }),
	20:	({ 61003, 61004, 62006, 62007, 62008, 62009, 62010, 62011, 62012, 62013, 62014, 63007, 63008, 63009, 64013, 64014, 64015, 64016, 64017, 64018, 64019, 64020, 64021, 64022, 64023, 64024, 65009, 65010, 65011, 65012, 65013, 65014, 65015, 65016, 65017, 65018, 65019, 66007, 66008, 66009, }),
	30:	({ 61005, 61006, 62015, 62016, 62017, 62018, 62019, 62020, 62021, 62022, 62023, 62024, 62025, 62026, 62027, 63010, 63011, 63012, 63013, 64025, 64026, 64027, 64028, 64029, 64030, 64031, 64032, 64033, 64034, 64035, 64036, 64037, 64038, 64039, 64040, 64041, 64042, 64043, 64044, 64045, 64046, 64047, 65020, 65021, 65022, 65023, 65024, 65025, 65026, 65027, 65028, 65029, 65030, 66010, 66011, 66012, 66013, 66014, 66015, 66016, }),
	40:	({ 61007, 61008, 62028, 62029, 62030, 62031, 62032, 62033, 62034, 62035, 63014, 63015, 63016, 63017, 64048, 64049, 64050, 64052, 64053, 64054, 64055, 64056, 64057, 64058, 64059, 64060, 64061, 64062, 64063, 64064, 64065, 64066, 64067, 64068, 64069, 64070, 64071, 64072, 65031, 65032, 65033, 65034, 65035, 65036, 65037, 65038, 65039, 65040, 65041, 65042, 65043, 65044, 65045, 65046, 66017, 66018, 66019, 66020, 66021, 66022, 66023, 66024, 66025, 66026, }),
	50:	({ 61009, 61010, 61011, 62036, 62037, 62038, 62039, 62040, 62041, 62042, 62043, 62044, 62045, 62046, 63018, 63019, 63020, 63021, 63022, 64073, 64074, 64075, 64076, 64077, 64078, 64079, 64080, 64081, 64082, 64083, 64084, 64085, 64086, 64087, 64088, 64089, 64090, 64091, 64092, 64093, 64094, 65047, 65048, 65049, 65050, 65051, 65052, 65053, 65054, 65055, 65056, 65057, 65058, 65059, 65060, 66027, 66028, 66029, 66030, 66031, 66032, 66033, 66034, 66035, }),
	60:	({ 61012, 61013, 62047, 62048, 62049, 62050, 62051, 62052, 62053, 62054, 62055, 62056, 62057, 63023, 63024, 63025, 63026, 63027, 63028, 64095, 64096, 64097, 64098, 64099, 64100, 64101, 64102, 64103, 64104, 64105, 64106, 64107, 64108, 64109, 64110, 64111, 64112, 64113, 64114, 64115, 64116, 64117, 64118, 65061, 65062, 65063, 65064, 65065, 65066, 65067, 65068, 65069, 65070, 65071, 66036, 66037, 66038, 66039, 66040, 66041, 66042, 66043, }),
	70:	({ 61014, 61015, 62058, 62059, 62060, 62061, 62062, 62063, 62064, 62065, 62066, 62067, 62068, 63029, 63030, 63031, 63032, 63033, 63034, 63035, 63036, 63037, 63038, 64119, 64120, 64121, 64122, 64123, 64124, 64125, 64126, 64127, 64128, 64129, 64130, 64131, 64132, 64133, 64134, 64135, 64136, 64137, 64138, 64139, 65072, 65073, 65074, 65075, 65076, 65077, 65078, 65079, 65080, 65081, 65082, 66044, 66045, 66046, 66047, 66048, 66049, 66050, 66051, }),
	80:	({ 61016, 61017, 62069, 62070, 62071, 62072, 62073, 62074, 62075, 62076, 62077, 62078, 62079, 62080, 62081, 62082, 62083, 63039, 64140, 64141, 64142, 64143, 64144, 64145, 64146, 64147, 64148, 64149, 64150, 64151, 64152, 64153, 64154, 64155, 64156, 64157, 64158, 64159, 64160, 64161, 64162, 64163, 65083, 65084, 65085, 65086, 65087, 65088, 65089, 65090, 65091, 65092, 65093, 66052, 66053, 66054, 66055, 66056, }),
	90:	({ 62084, 62085, 62086, 62087, 62088, 62089, 62090, 62091, 62092, 62093, 62094, 62095, 64164, 64165, 64166, 64167, 64168, 64169, 64170, 64171, 64172, 64173, 64174, 64175, 64176, 64177, 64178, 64179, 64180, 64181, 64182, 64183, 64184, 64185, 65094, 65095, 65096, 65097, 65098, 65099, 65100, 65101, 65102, 65103, 65104, }),
	100:	({ 62096, 62097, 62098, 62099, 62100, 62101, 62102, 62103, 62104, 64186, 64187, 64188, 64189, 64190, 64191, 64192, 64193, 64194, 64195, 64196, 64197, 64198, 64199, 64200, 64201, 64202, 64203, 64204, 64205, 64206, 65105, 65106, 65107, 65108, 65109, 65110, 65111, 65112, 65113, 65114, }),
	110:	({ 62105, 62106, 62107, 62108, 62109, 62110, 65115, 65116, 65117, 65118, 65119, 65120, 65121, 65122, 65123, 65124, }),
	
	]);

mapping blue_product = ([
	25:	({ 65501, 65502, 65503, 65504, 65505, 65506, 65507, }),
	35:	({ 62300, 62301, 62302, 62303, 62304, 62305, 64501, 64502, 64503, 64504, 64505, 64506, 64507, 65508, 65509, 65510, 65511, 65512, 65513, 65514, }),
	45:	({ 62306, 62307, 62308, 62309, 62310, 62311, 64508, 64509, 64510, 64511, 64512, 64513, 64514, 64515, 64516, 64517, 64518, 64519, 64520, 64521, 64522, 64523, 64524, 64525, 64526, 64527, 64528, 65515, 65516, 65517, 65518, 65519, 65520, 65521, }),
	55:	({ 62312, 62313, 62314, 62315, 62316, 62317, 64529, 64530, 64531, 64532, 64533, 64534, 64535, 64536, 64537, 64538, 64539, 64540, 64541, 64542, 64543, 64544, 64545, 64546, 64547, 64548, 64549, 65522, 65523, 65524, 65525, 65526, 65527, 65528, }),
	65:	({ 62318, 62319, 62320, 62321, 62322, 62323, 64550, 64551, 64552, 64553, 64554, 64555, 64556, 64557, 64558, 64559, 64560, 64561, 64562, 64563, 64564, 64565, 64566, 64567, 64568, 64569, 64570, 65529, 65530, 65531, 65532, 65533, 65534, 65535, }),
	75:	({ 62324, 62325, 62326, 62327, 62328, 62329, 64571, 64572, 64573, 64574, 64575, 64576, 64577, 64578, 64579, 64580, 64581, 64582, 64583, 64584, 64585, 64586, 64587, 64588, 64589, 64590, 64591, 65536, 65537, 65538, 65539, 65540, 65541, 65542, }),
	85:	({ 62330, 62331, 62332, 62333, 62334, 62335, 64592, 64593, 64594, 64595, 64596, 64597, 64598, 64599, 64600, 64601, 64602, 64603, 64604, 64605, 64606, 64607, 64608, 64609, 64610, 64611, 64612, 65543, 65544, 65545, 65546, 65547, 65548, 65549, }),
	95:	({ 62336, 62337, 62338, 62339, 62340, 62341, 64613, 64614, 64615, 64616, 64617, 64618, 64619, 64620, 64621, 64622, 64623, 64624, 64625, 64626, 64627, 64628, 64629, 64630, 64631, 64632, 64633, 65550, 65551, 65552, 65553, 65554, 65555, 65556, }),
	105:	({ 62342, 62343, 62344, 62345, 62346, 62347, 64634, 64635, 64636, 64637, 64638, 64639, 64640, 64641, 64642, 64643, 64644, 64645, 64646, 64647, 64648, 64649, 64650, 64651, 64652, 64653, 64654, 65557, 65558, 65559, 65560, 65561, 65562, 65563, }),
	115:	({ 62348, 62349, 62350, 62351, 62352, 62353, 64655, 64656, 64657, 64658, 64659, 64660, 64661, 64662, 64663, 64664, 64665, 64666, 64667, 64668, 64669, 64670, 64671, 64672, 64673, 64674, 64675, 65564, 65565, 65566, 65567, 65568, 65569, 65570, }),
	119:	({ 64697, 64698, 64699, 64700, 64701, 64702, 64703, 64704, 64705, 64706, 64707, 64708, 64709, 64710, 64711, 64712, 64713, 64714, 64715, 64716, 64717, 65571, 65572, 65573, 65574, 65575, 65576, 65577, }),
	120:	({ 62354, 62355, 62356, 62357, 62358, 62359, 64676, 64677, 64678, 64679, 64680, 64681, 64682, 64683, 64684, 64685, 64686, 64687, 64688, 64689, 64690, 64691, 64692, 64693, 64694, 64695, 64696, }),
	]);	
	
mapping yellow_product = ([
	47:	({ 64718, 64719, 64720, 64721, 64722, 64723, }),
	57:	({ 64724, 64725, 64726, 64727, 64728, 64729, }),
	67:	({ 64730, 64731, 64732, 64733, 64734, 64735, }),
	77:	({ 64736, 64737, 64738, 64739, 64740, 64741, }),
	87:	({ 64742, 64743, 64744, 64745, 64746, 64747, }),
	97:	({ 64748, 64749, 64750, 64751, 64752, 64753, }),
	107:	({ 64754, 64755, 64756, 64757, 64758, 64759, }),
	117:	({ 64760, 64761, 64762, 64763, 64764, 64765, }),
	127:	({ 64766, 64767, 64768, 64769, 64770, 64771, }),
	]);
	
mapping yellow_neck_product = ([ 46: ({ 65708,}), 56: ({ 65709,}), 76: ({ 65710,}), 86: ({ 65711,}), 96: ({ 65712,}), 106: ({ 65713,}), 116: ({ 65714,}), 126: ({ 65715,}), ]);
	
int * card = ({ 0902, 0950, 0951, 0952, 0953, 0954, 1000, 1001, 1050, 1051, 1052, 1100, 1101, 1102, 4141, 4142, 4143, 4145, 8000, 8012, 8013, });	
	
int *type1 = white_product[80] + white_product[90];
int *type2 = white_product[100] + white_product[110];
int *type3 = blue_product[35] + blue_product[45] + blue_product[55];
int *type4 = blue_product[65] + blue_product[75] + blue_product[85];
int *type5 = blue_product[95] + blue_product[105] + blue_product[115];
int *type6 = blue_product[119] + blue_product[120];	

// 函数：获取产品文件
int * get_product_file(int type) 
{ 
	if (product[ type ])
		return product[ type ]; 
	else
		return ({ });
}

int check_product()
{
	int i, j, size;
	object file;
	for (i=0;i<=110;i+=10)
	{
		size = sizeof(white_product[i]);
		for (j = 0;j<size;j++)
		{
			file = load_object(sprintf("/item/product/%d", white_product[i][j] ));	
			if (file) tell_user(this_player(), file->get_name());
			else tell_user(this_player(), sprintf("/item/product/%d找不到", product[i][j] ));
		}
	}
	return 1;
}

string get_random_product()
{
	int * all;
	int i, size;
	all = ({ });
	for (i=30;i<=120;i+=10)
		all += product[i];
	size = sizeof(all);
	i = random(size);
	return sprintf("/item/product/%d", all[i]);
}

string get_random_product2(int grade)
{
	int * all;
	int i, size;
	all = ({ });
	if (grade>=10)
	{
		grade = (grade /10)*10;
		if (grade<30) grade = 30;
		if (grade>120) grade = 120;
		all = product[grade];
		size = sizeof(all);
		if (size==0)
		{
			all += product[30];
			size = size = sizeof(all);
		}	
		i = random(size);
		return sprintf("/item/product/%d", all[i]);			
	}
	switch(grade)
	{
	case 5:
		all += product[120];
		all += product[110];
	case 4:
		all += product[100];
		all += product[90];
	case 3:
		all += product[80];
		all += product[70];
	case 2:
		all += product[60];
		all += product[50];
	case 1:
		all += product[40];
		all += product[30];
		break;
	}
	size = sizeof(all);
	if (size==0)
	{
		all += product[30];
		size = size = sizeof(all);
	}	
	i = random(size);
	return sprintf("/item/product/%d", all[i]);	
}

string get_random_drop_product(int type)
{
	int * all;
	int i, size;
	all = ({ });
	switch(type)
	{
	case 1:		// 30 级
		all += product[30];
		break;
	case 2:		// 40 级
		all += product[40];
		break;
	case 3:		// 40-50级
		all += product[40];
		all += product[50];
		break;
	case 4:		// 50-80级
		all += product[50];
		all += product[60];
		all += product[70];
		all += product[80];
		break;
	case 5:		// 60-90级
		all += product[60];
		all += product[70];
		all += product[80];
		all += product[80];
		break;
	case 6:		// 80-120级
		all += product[80];
		all += product[90];
		all += product[100];
		all += product[110];
		all += product[120];
		break;		
	case 7:		// 40-60级
		all += product[40];
		all += product[50];
		all += product[60];
		break;
	case 8:		// 50 级
		all += product[50];
		break;

	}
	size = sizeof(all);
	if (size==0)
	{
		all += product[30];
		size = sizeof(all);
	}
	i = random(size);
	return sprintf("/item/product/%d", all[i]);	
}

string get_random_level_product(int begin, int end)
{
	int * all;
	int i, size;
	all = ({ });
	if (begin>end||end<30)
	{
		all += product[30];
	}	
	else
	{
		begin = (begin/10)*10;
		end = (end/10)*10;		
		if (begin<30) begin=30;
		if (end>120) end=120;		
		if (begin>end) begin = end;
		for (i = begin;i<=end;i+=10)
			all += product[i];		
	}
	size = sizeof(all);		
	i = random(size);
	return sprintf("/item/product/%d", all[i]);		
}

string * get_random_list(int count)
{
	int i, rand;
	string *ret;
	ret = ({ });
	for (i=0;i<count;i++)
	{
		rand = random100();
		if (rand<30) ret += ({ sprintf("/item/product/%d", type1[random(sizeof(type1))] ) });
		else
		if (rand<55) ret += ({ sprintf("/item/product/%d", type2[random(sizeof(type2))] ) });
		else
		if (rand<80) ret += ({ sprintf("/item/product/%d", type3[random(sizeof(type3))] ) });
		else
		if (rand<94) ret += ({ sprintf("/item/product/%d", type4[random(sizeof(type4))] ) });
		else
		if (rand<99) ret += ({ sprintf("/item/product/%d", type5[random(sizeof(type5))] ) });
		else
			ret += ({ sprintf("/item/product/%d", type6[random(sizeof(type6))] ) });			
	}
	return ret;
}

string get_random_level_white_product(int begin, int end)
{
	int * all;
	int i, size;
	all = ({ });	
	begin = (begin/10)*10;
	end = (end/10)*10;		
	if (end>110) end=110;		
	if (begin>end) begin = end;
	for (i = begin;i<=end;i+=10)
		all += white_product[i];			
	size = sizeof(all);		
	i = random(size);
	return sprintf("/item/product/%d", all[i]);		
}

string get_random_level_blue_product(int begin, int end)
{
	int * all;
	int i, size, end2, begin2;
	all = ({ });
	if (begin>end||end<25)
	{
		all += blue_product[25];
	}	
	else
	{
		begin2 = begin;
		end2 = end;
		begin = (begin/10)*10+5;
		end = (end/10)*10+5;	
		if (begin2>115)
		{
			all += blue_product[119];
			all += blue_product[120];
		}
		else
		{
			if (begin<25) begin=25;
			if (end>=115) end=115;		
			for (i = begin;i<=end;i+=10)
				all += blue_product[i];
			if (end2>115)
			{
				all += blue_product[119];
				all += blue_product[120];				
			}
		}		
	}
	size = sizeof(all);		
	i = random(size);
	return sprintf("/item/product/%d", all[i]);		
}

string get_random_card() { return sprintf("/item/54/%04d", card[ random(sizeof(card)) ]); }

//金色图纸
string get_random_level_yellow_product(int begin, int end)
{
	int * all;
	int i, size, end2, begin2;
	all = ({ });
	if (begin>end||end<47)
	{
		all += yellow_product[47];
	}	
	else
	{
		begin2 = begin;
		end2 = end;

		if (begin<47) begin=47;
		if (end>=127) end=127;
		for (i = begin;i<=end;i+=10)
			all += yellow_product[i];
	}
	size = sizeof(all);
	i = random(size);
	return sprintf("/item/product/%d", all[i]);
}

//金色项链
string get_random_level_yellow_neck_product(int begin, int end)
{
	int * all;
	int i, size, end2, begin2;
	all = ({ });
	if (begin>end||end<46)
	{
		all += yellow_neck_product[46];   //留组，可添加。
	}	
	else
	{
		begin2 = begin;
		end2 = end;

		if (begin<46) begin=46;
		if (end>=126) end=126;
		for (i = begin;i<=end;i+=10)      //遍历组
			all += yellow_neck_product[i];
	}
	size = sizeof(all);
	i = random(size);                         //保留随机挑选组，以便扩展
	return sprintf("/item/product/%d", all[i]);
}